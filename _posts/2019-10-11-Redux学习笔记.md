---
layout:     post
title:      Reacté€šä¿¡åˆ©å™¨--Redux

subtitle:   è¿™åˆæ˜¯ä¸€ç¯‡å­¦ä¹ ç¬”è®°
date:       2019-10-11
author:     Laqudee.Z
header-img: img/post-bg-debug.png
catalog: false
tags:
    - Front End
    - Redux
---

- [Reduxå®˜ç½‘å­¦ä¹ æ•™ç¨‹å‚è€ƒ](https://redux.js.org/introduction/getting-started)

- Reactçš„é€šä¿¡æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œå‘åŸå§‹çš„ç”µè¯é€šä¿¡ï¼
- Reduxï¼Œç±»ä¼¼ä¸€ä¸ªé€šä¿¡äº‘å­˜å‚¨ï¼Œå°†æ‰€æœ‰çš„å…¬å…±çŠ¶æ€å­˜åœ¨äº‘ä¸Šï¼Œåªè¦çŠ¶æ€ä¸€æ”¹å˜ï¼Œä¸ªç»„ä»¶éƒ½èƒ½å–åˆ°çŠ¶æ€çš„æœ€æ–°å€¼ã€‚
- ä½¿ç”¨Reduxéœ€è¦æŒæ¡å“ªäº›é‡è¦çš„APIï¼š
  - storeï¼šstoreå¯¹è±¡æ˜¯ä¿å­˜å…¬å…±æ•°æ®çš„åœ°æ–¹ï¼Œä¸€ä¸ªåº”ç”¨åªèƒ½åˆ›å»ºä¸€ä¸ªstoreï¼Œåˆ›å»ºæ–¹æ³•å¦‚ä¸‹ï¼š
  
```js
import {createStore} from 'redux';

const store = crateStore(function);
```

  - state: stateæ˜¯storeæ˜ å°„çš„æ•°æ®é›†åˆï¼Œä¸€ä¸ªstateåªèƒ½å¯¹åº”ä¸€ä¸ªviewï¼Œåˆ›å»ºæ–¹æ³•å¦‚ä¸‹ï¼š
  
```js
import {createStore} from 'redux';

const store = crateStore(function);

const state = store.getState(); //é€šè¿‡store.getStore()æ‹¿åˆ°state
```

  - actionï¼šstateå’Œviewæ˜¯ç»“å¯¹çš„ï¼Œviewå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šç”¨actionå‘å‡ºé€šçŸ¥ã€‚actionæ˜¯æ”¹å˜stateçš„å”¯ä¸€æ–¹æ³•
    - actionå¿…è¦å±æ€§ï¼štypeï¼Œå…¶ä»–å±æ€§å¯ä»¥è‡ªç”±è®¾ç½®ã€‚

  - store.dispatch(): store.patch()æ˜¯viewå‘å‡ºactionçš„å”¯ä¸€æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š
  
```js
store.dispatch({
    type:'student_age',
    age: 12
    name: 'hanmeimei'
});
```

  - reducer: reduceræ˜¯ä¸€ä¸ªè®¡ç®—stateçš„å‡½æ•°ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå½“å‰stateå’Œactionã€‚
   - å½“storeæ”¶åˆ°actioné€šçŸ¥åï¼Œä¸€å®šè¦è¿”å›ä¸€ä¸ªå…¨æ–°çš„stateã€‚
   - storeæ¥æ”¶åˆ°actionä¼ æ¥çš„æ•°æ®ï¼Œç„¶åæ ¹æ®é€»è¾‘è®¡ç®—æ•°æ®ï¼Œè¯¥è¿‡ç¨‹å°±ç§°ä¸ºreducer.
   - ç¤ºä¾‹å¦‚ä¸‹ï¼š
  
```js
import {createStore} from 'redux';
const reducer = (state = defaultState, action) => {
    switch(action.type){
        case 'student_age':
        return state;
        default:
        return 
    }
}
const store = createStore(reducer); //ç”Ÿæˆstoreæ—¶ï¼Œä¼ å…¥reducer
```

  - store.subscribe()ï¼šstore.subscribe()ç›‘å¬stateå˜åŒ–ï¼Œstateä¸€æ—¦å˜åŒ–å°±è‡ªåŠ¨è§¦å‘è¯¥å‡½æ•°ã€‚
   - ç¤ºä¾‹ï¼š
  
```js
import {createStore} from 'redux';
const store = createStore(reducer);
store.subscribe(listen);
```

- Reduxçš„è¿è¡ŒåŸç†ï¼š

![è¿è¡ŒåŸç†å›¾](/img/redux_1.png)

- storeä¸­çš„é‡è¦æ–¹æ³•ï¼š

![æ–¹æ³•](/img/redux_2.png)

- ç›®å‰ï¼ŒReactæ¡†æ¶dvaå°±èå…¥äº†Reduxçš„è®¾è®¡æ€æƒ³ï¼Œä¼¼çš„dvaæ¡†æ¶æ›´æ–¹ä¾¿ä½¿ç”¨ï¼

- Basic Example
  - å®˜ç½‘æ•™ç¨‹ç¤ºä¾‹

```js
import { createStore } from 'redux'

/**
 * This is a reducer, a pure function with (state, action) => state signature.
 * It describes how an action transforms the state into the next state.
 *
 * The shape of the state is up to you: it can be a primitive, an array, an object,
 * or even an Immutable.js data structure. The only important part is that you should
 * not mutate the state object, but return a new object if the state changes.
 *
 * In this example, we use a `switch` statement and strings, but you can use a helper that
 * follows a different convention (such as function maps) if it makes sense for your
 * project.
 */
function counter(state = 0, action) {
  switch (action.type) {
    case 'INCREMENT':
      return state + 1
    case 'DECREMENT':
      return state - 1
    default:
      return state
  }
}

// Create a Redux store holding the state of your app.
// Its API is { subscribe, dispatch, getState }.
let store = createStore(counter)

// You can use subscribe() to update the UI in response to state changes.
// Normally you'd use a view binding library (e.g. React Redux) rather than subscribe() directly.
// However it can also be handy to persist the current state in the localStorage.

store.subscribe(() => console.log(store.getState()))

// The only way to mutate the internal state is to dispatch an action.
// The actions can be serialized, logged or stored and later replayed.
store.dispatch({ type: 'INCREMENT' })
// 1
store.dispatch({ type: 'INCREMENT' })
// 2
store.dispatch({ type: 'DECREMENT' })
// 1
```

> æœ¬æ–‡é¦–å‘äº[Laqudee Blog](https://zhaoylong.github.io)ï¼Œç»™ä½œè€…[GitHub](https://github.com/ZhaoYLong))é‡Œçš„é¡¹ç›®â•ğŸŒŸ!